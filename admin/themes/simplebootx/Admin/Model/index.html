<admintpl file="header" />
</head>
<body>
	<div class="wrap js-check-wrap">
		<ul class="nav nav-tabs">
			<li class="active"><a href="{:U('model/index')}">{:L('ADMIN_MODEL_DEF')}</a></li>
            <li><a href="{:U('model/add')}">{:L('ADMIN_MODEL_ADD')}</a></li>
			<!--<li><a href="{:U('model/add')}">{:L('ADMIN_MENU_ADD')}</a></li>-->
			<!--<li><a href="{:U('menu/spmy_import_menu')}">{:L('ADMIN_MENU_SPMY_IMPORT_MENU')}</a></li>-->
			<!--<if condition="APP_DEBUG">
			<li><a href="{:U('menu/lists')}">{:L('ADMIN_MENU_LISTS')}</a></li>
			<li><a href="{:U('menu/spmy_export_menu')}">备份菜单</a></li>
			<li><a href="{:U('menu/spmy_export_menu_lang')}">生成菜单多语言包</a></li>
			</if>-->
		</ul>
		<form class="js-ajax-form" action="{:U('Model/listorders')}" method="post" id="model_list">
			<div class="table-actions">
				<button class="btn btn-primary btn-small js-ajax-submit" type="submit">{:L('SORT')}</button>
                <button class="btn btn-primary btn-small pull-right" type="button" id="admin_model_add">{:L('ADMIN_MODEL_ADD')}</button>
			</div>
			<table class="table table-hover table-bordered table-list" id="model-table">
				<thead>
					<tr>
						<th width="50">{:L('SORT')}</th>
						<th width="50">{:L('ADMIN_MODEL_ID')}</th>
						<th>{:L('ADMIN_MODEL_NAME')}</th>
						<th width="200">{:L('ADMIN_MODEL_TABLE')}</th>
						<th width="200">{:L('ADMIN_MODEL_DESC')}</th>
						<th width="180">{:L('ACTIONS')}</th>
					</tr>
				</thead>
				<tbody>
                    <foreach name="list" item="vo">
                        <tr id='node-{$vo.modelid}' >
                            <td style='padding-left:10px;'>
                                <input name='listorders[{$vo.modelid}]' type='text' size='3' value='{$vo.listorder}' class='input input-order'></td>
                            <td>{$vo.modelid}</td>
                            <td>{$vo.name}</td>
                            <td>{$vo.tablename}</td>
                            <td>{$vo.description}</td>
                            <td>
                                <a href="{:U('Model/field_index', array('modelid' => $vo['modelid']))}">{:L('ADMIN_MODEL_FIELD_DEF')}</a> | 
                                <a href="{:U('Model/edit', array('modelid' => $vo['modelid']))}">{:L('EDIT')}</a> | 
                                <a class="js-ajax-delete" href="{:U('Model/delete', array('modelid' => $vo['modelid']))}">{:L('DELETE')}</a>
                            </td>
                        </tr>
				    </foreach>
				</tbody>
				<tfoot>
					<tr>
						<th width="50">{:L('SORT')}</th>
						<th width="50">{:L('ADMIN_MODEL_ID')}</th>
						<th>{:L('ADMIN_MODEL_NAME')}</th>
						<th width="200">{:L('ADMIN_MODEL_TABLE')}</th>
						<th width="300">{:L('ADMIN_MODEL_DESC')}</th>
						<th width="180">{:L('ACTIONS')}</th>
					</tr>
				</tfoot>
			</table>
			<div class="table-actions">
				<button class="btn btn-primary btn-small js-ajax-submit" type="submit">{:L('SORT')}</button>
			</div>
		</form>
	</div>
	<script src="__PUBLIC__/js/common.js"></script>
	<script>
		$(document).ready(function() {
			Wind.css('treeTable');
			Wind.use('treeTable', function() {
				$("#model-table").treeTable({
					indent : 20
				});
			});
		});

		setInterval(function() {
			var refersh_time = getCookie('refersh_time_admin_model_index');
			if (refersh_time == 1) {
				reloadPage(window);
			}
		}, 1000);
		setCookie('refersh_time_admin_menu_index', 0);
        //添加模型
        $("#admin_model_add").click(function(){
            $("#model_list").attr("action","{:U('Model/add')}");
            $("#model_list").submit();
        });
	</script>
</body>
</html>